syntax = "proto3";
package addons;
import "google/protobuf/empty.proto";

enum AddonPurchaseStatusGrpc {
  STARTED = 0;
  COMPLETED = 1;
  REFUNDED = 2;
  LOST = 3;
}

enum AddonModifierTypeGrpc {
  PAYOUT_SCHEDULE = 0;
  PROFIT_SPLIT = 1;
}

message AddonModifierGrpcModel {
  AddonModifierTypeGrpc Type = 1;
  string Value = 2;
}

message AddonGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double Price = 4;
  AddonModifierGrpcModel Modifier = 5;
  int64 UpdatedAt = 6;
}

message AddonPurchaseGrpcModel {
  string ClientId = 1;
  string TraderAccountId = 2;
  string PurchaseId = 3;
  int64 UpdatedAt = 4;
  repeated AddonGrpcModel Addons = 5;
  repeated AddonBundleGrpcModel Bundles = 6;
  map<string, double> AddonFullPrices = 7;
  map<string, double> AddonDiscountPrices = 8;
  double FullPrice = 9;
  optional double DiscountPrice = 10;
  AddonPurchaseStatusGrpc Status = 11;
}

message AddonBundleGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double DiscountPercent = 4;
  repeated string AddonIds = 5;
  int64 UpdatedAt = 6;
}

message GetAddonsGrpcRequest {}

message GetAddonsGrpcResponse {
  AddonGrpcModel Items = 1;
}

message GetBundlesGrpcRequest {}

message GetBundlesGrpcResponse {
  AddonBundleGrpcModel Items = 1;
}

message AddOrUpdateAddonsGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message AddOrUpdateAddonsGrpcResponse {}

message AddOrUpdateBundlesGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message AddOrUpdateBundlesGrpcResponse {}

message GetPurchasesGrpcRequest {
  uint32 Limit = 1;
  uint32 Offset = 2;
  repeated string ClientIds = 3;
  repeated string TraderAccountIds = 4;
  repeated string PurchaseIds = 5;
  repeated AddonPurchaseStatusGrpc Statuses = 6;
}

message GetPurchasesGrpcResponse {
  AddonPurchaseGrpcModel Items = 1;
}

message DeleteAddonGrpcRequest {
  string Id = 1;
}

message DeleteAddonGrpcResponse {}

message DeleteBundleGrpcRequest {
  string Id = 1;
}

message DeleteBundleGrpcResponse {}

message CompletePurchaseGrpcRequest {
  string Id = 1;
  string ClientId = 2;
  string TraderAccountId = 3;
  string PurchaseId = 4;
  double TotalPaidAmount = 5;
  map<string, double> PaidAmountsByAddonIds = 6;
}

message CompletePurchaseGrpcResponse {
  AddonPurchaseGrpcModel Item = 1;
}

message StartPurchaseGrpcRequest {
  string ClientId = 1;
  string TraderAccountId = 2;
  string PurchaseId = 3;
  double PurchasePrice = 4;
  repeated string AddonIds = 5;
  repeated string BundleIds = 6;
}

message StartPurchaseGrpcResponse {
  AddonPurchaseGrpcModel Item = 1;
}

service AddonsGrpcService {
  rpc GetAddons(GetAddonsGrpcRequest) returns (GetAddonsGrpcResponse);
  rpc DeleteAddon(DeleteAddonGrpcRequest) returns (DeleteAddonGrpcResponse);
  rpc AddOrUpdateAddons(AddOrUpdateAddonsGrpcRequest) returns (AddOrUpdateAddonsGrpcResponse);

  rpc GetBundles(GetBundlesGrpcRequest) returns (GetBundlesGrpcResponse);
  rpc DeleteBundle(DeleteBundleGrpcRequest) returns (DeleteBundleGrpcResponse);
  rpc AddOrUpdateBundles(AddOrUpdateBundlesGrpcRequest) returns (AddOrUpdateBundlesGrpcResponse);

  rpc StartPurchase(StartPurchaseGrpcRequest) returns (StartPurchaseGrpcResponse);
  rpc CompletePurchase(CompletePurchaseGrpcRequest) returns (CompletePurchaseGrpcResponse);
  rpc GetPurchases(GetPurchasesGrpcRequest) returns (GetPurchasesGrpcResponse);

  rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
