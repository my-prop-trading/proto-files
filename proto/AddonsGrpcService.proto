syntax = "proto3";
package addons;
import "google/protobuf/empty.proto";

enum AddonOrderStatusGrpc {
  PENDING = 0;
  PAID = 1;
  REFUNDED = 2;
  LOST = 3;
}

enum AddonModifierTypeGrpc {
  PAYOUT_SCHEDULE = 0;
  PROFIT_SPLIT = 1;
}

message AddonModifierGrpcModel {
  AddonModifierTypeGrpc Type = 1;
  string Value = 2;
}

message AddonGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double Price = 4;
  AddonModifierGrpcModel Modifier = 5;
  int64 UpdatedAt = 6;
}

message AddonOrderGrpcModel {
  string Id = 1;
  string ClientId = 2;
  string TraderAccountId = 3;
  string OrderId = 4;
  int64 UpdatedAt = 5;
  repeated AddonGrpcModel Addons = 6;
  repeated AddonBundleGrpcModel Bundles = 7;
  map<string, double> AddonFullPrices = 8;
  map<string, double> AddonDiscountPrices = 9;
  double FullPrice = 11;
  optional double DiscountPrice = 12;
}

message AddonBundleGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double DiscountPercent = 4;
  repeated string AddonIds = 5;
  int64 UpdatedAt = 6;
}

message GetAddonsGrpcRequest {}

message GetAddonsGrpcResponse {
  AddonGrpcModel Items = 1;
}

message GetBundlesGrpcRequest {}

message GetBundlesGrpcResponse {
  AddonBundleGrpcModel Items = 1;
}

message CreateOrUpdateAddonsGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message CreateOrUpdateAddonsGrpcResponse {}

message CreateOrUpdateBundlesGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message CreateOrUpdateBundlesGrpcResponse {}

message GetOrdersGrpcRequest {
  uint32 Limit = 1;
  uint32 Offset = 2;
  repeated string ClientIds = 3;
  repeated string TraderAccountIds = 4;
  repeated string OrderIds = 5;
}

message GetOrdersGrpcResponse {
  AddonOrderGrpcModel Items = 1;
}

message DeleteAddonGrpcRequest {
  string Id = 1;
}

message DeleteAddonGrpcResponse {}

message DeleteBundleGrpcRequest {
  string Id = 1;
}

message DeleteBundleGrpcResponse {}

message PayOrderGrpcRequest {
  string Id = 1;
  string ClientId = 2;
  string TraderAccountId = 3;
  string OrderId = 4;
  double TotalPaidAmount = 5;
  map<string, double> PaidAmountsByAddonIds = 6;
}

message PayOrderGrpcResponse {
  AddonOrderGrpcModel Item = 1;
}

message CreateOrderGrpcRequest {
  string ClientId = 1;
  string TraderAccountId = 2;
  string OrderId = 3;
  double OrderPrice = 4;
  repeated string AddonIds = 5;
  repeated string BundleIds = 6;
}

message CreateOrderGrpcResponse {
  AddonOrderGrpcModel Item = 1;
}

service AddonsGrpcService {
  rpc GetAddons(GetAddonsGrpcRequest) returns (GetAddonsGrpcResponse);
  rpc DeleteAddon(DeleteAddonGrpcRequest) returns (DeleteAddonGrpcResponse);
  rpc CreateOrUpdateAddons(CreateOrUpdateAddonsGrpcRequest) returns (CreateOrUpdateAddonsGrpcResponse);

  rpc GetBundles(GetBundlesGrpcRequest) returns (GetBundlesGrpcResponse);
  rpc DeleteBundle(DeleteBundleGrpcRequest) returns (DeleteBundleGrpcResponse);
  rpc CreateOrUpdateBundles(CreateOrUpdateBundlesGrpcRequest) returns (CreateOrUpdateBundlesGrpcResponse);

  rpc CreateOrder(CreateOrderGrpcRequest) returns (CreateOrderGrpcResponse);
  rpc PayOrder(PayOrderGrpcRequest) returns (PayOrderGrpcResponse);
  rpc GetOrders(GetOrdersGrpcRequest) returns (GetOrdersGrpcResponse);

  rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
