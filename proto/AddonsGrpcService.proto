syntax = "proto3";
package addons;
import "google/protobuf/empty.proto";

enum AddonOrderStatusGrpc {
  ORDER_STARTED = 0;
  ORDER_COMPLETED = 1;
}

enum AddonStatusGrpc {
  ACTIVE = 0;
  REFUNDED = 1;
  LOST = 2;
}

enum AddonModifierTypeGrpc {
  PAYOUT_SCHEDULE = 0;
  PROFIT_SPLIT = 1;
}

message AddonModifierGrpcModel {
  AddonModifierTypeGrpc Type = 1;
  string Value = 2;
}

message AddonGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double Price = 4;
  AddonModifierGrpcModel Modifier = 5;
  int64 UpdatedAt = 6;
}

message AddonPurchaseGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double Price = 4;
  AddonModifierGrpcModel Modifier = 5;
  int64 UpdatedAt = 6;
  string ClientId = 8;
  string OrderId = 9;
  string TraderAccountId = 10;
  double FullPrice = 11;
  optional double DiscountPrice = 12;
  string ParentId = 13;
  AddonStatusGrpc Status = 14;
  optional string BundleId = 15;
}

message AddonOrderGrpcModel {
  string OrderId = 1;
  string ClientId = 2;
  int64 UpdatedAt = 3;
  repeated AddonGrpcModel Addons = 4;
  repeated AddonBundleGrpcModel Bundles = 5;
  map<string, double> AddonFullPrices = 6;
  map<string, double> AddonDiscountPrices = 7;
  double FullPrice = 8;
  optional double DiscountPrice = 9;
  AddonOrderStatusGrpc Status = 10;
}

message AddonBundleGrpcModel {
  string Id = 1;
  string Name = 2;
  string Description = 3;
  double DiscountPercent = 4;
  repeated string AddonIds = 5;
  int64 UpdatedAt = 6;
}

message GetAddonsGrpcRequest {}

message GetAddonsGrpcResponse {
  AddonGrpcModel Items = 1;
}

message GetBundlesGrpcRequest {}

message GetBundlesGrpcResponse {
  AddonBundleGrpcModel Items = 1;
}

message AddOrUpdateAddonsGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message AddOrUpdateAddonsGrpcResponse {}

message AddOrUpdateBundlesGrpcRequest {
  repeated AddonGrpcModel Items = 1;
}

message AddOrUpdateBundlesGrpcResponse {}

message GetOrdersGrpcRequest {
  uint32 Limit = 1;
  uint32 Offset = 2;
  repeated string ClientIds = 3;
  repeated string TraderAccountIds = 4;
  repeated string OrderIds = 5;
  repeated AddonOrderStatusGrpc Statuses = 6;
}

message GetOrdersGrpcResponse {
  AddonOrderGrpcModel Items = 1;
}

message DeleteAddonGrpcRequest {
  string Id = 1;
}

message DeleteAddonGrpcResponse {}

message DeleteBundleGrpcRequest {
  string Id = 1;
}

message DeleteBundleGrpcResponse {}

message CompleteOrderGrpcRequest {
  string OrderId = 1;
  string TraderAccountId = 2;
}

message CompleteOrderGrpcResponse {
  AddonOrderGrpcModel Item = 1;
}

message StartOrderGrpcRequest {
  string ClientId = 1;
  double OrderPrice = 2;
  repeated string AddonIds = 3;
  repeated string BundleIds = 4;
  string OrderId = 6;
}

message StartOrderGrpcResponse {
  AddonOrderGrpcModel Item = 1;
}

service AddonsGrpcService {
  rpc GetAddons(GetAddonsGrpcRequest) returns (GetAddonsGrpcResponse);
  rpc DeleteAddon(DeleteAddonGrpcRequest) returns (DeleteAddonGrpcResponse);
  rpc AddOrUpdateAddons(AddOrUpdateAddonsGrpcRequest) returns (AddOrUpdateAddonsGrpcResponse);

  rpc GetBundles(GetBundlesGrpcRequest) returns (GetBundlesGrpcResponse);
  rpc DeleteBundle(DeleteBundleGrpcRequest) returns (DeleteBundleGrpcResponse);
  rpc AddOrUpdateBundles(AddOrUpdateBundlesGrpcRequest) returns (AddOrUpdateBundlesGrpcResponse);

  rpc StartOrder(StartOrderGrpcRequest) returns (StartOrderGrpcResponse);
  rpc CompleteOrder(CompleteOrderGrpcRequest) returns (CompleteOrderGrpcResponse);
  rpc GetOrders(GetOrdersGrpcRequest) returns (GetOrdersGrpcResponse);

  rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
